# PyDomino - 開発計画書

## 1. 開発概要

### 1.1 開発期間
- **開始日**: 2025年1月〜
- **Phase 1完了目標**: 2025年3月末
- **Phase 2完了目標**: 2025年6月末
- **Phase 3完了目標**: 2025年9月末

### 1.2 開発体制
- **開発者**: 1名（個人開発）
- **開発手法**: アジャイル開発（2週間スプリント）
- **バージョン管理**: Git

### 1.3 開発環境
- **OS**: macOS / Windows / Linux
- **Python**: 3.8+
- **IDE**: VSCode / PyCharm
- **パッケージ管理**: pip + requirements.txt

## 2. 開発フェーズ

### 2.1 Phase 1: 基本機能実装 (2025年1月〜3月)

#### 2.1.1 Sprint 1-2: プロジェクト基盤整備
- [x] プロジェクト構造の設計
- [x] 基本的なGUI フレームワーク構築
- [x] MIDIデータモデルの実装
- [x] 基本的なピアノロール表示

#### 2.1.2 Sprint 3-4: コア編集機能
- [x] 音符の作成・削除・移動
- [x] 音符の長さ調整
- [x] 基本的な選択機能
- [ ] 複数音符の選択（矩形選択）

#### 2.1.3 Sprint 5-6: ファイル操作強化
- [x] MIDIファイル読み込み
- [ ] MIDIファイル保存
- [ ] プロジェクトファイル形式設計
- [ ] エラーハンドリング強化

#### 2.1.4 Sprint 7-8: UI/UX改善
- [ ] キーボードショートカット
- [ ] 右クリックメニュー
- [ ] ツールバー実装
- [ ] 状況に応じたカーソル変更

### 2.2 Phase 2: 中級機能実装 (2025年4月〜6月)

#### 2.2.1 Sprint 9-10: 再生機能
- [ ] MIDI再生エンジン実装
- [ ] 再生コントロール（再生/停止/一時停止）
- [ ] 再生位置表示
- [ ] メトロノーム機能

#### 2.2.2 Sprint 11-12: 録音機能
- [ ] MIDI入力の実装
- [ ] リアルタイム録音
- [ ] 録音時の量子化
- [ ] 入力モニタリング

#### 2.2.3 Sprint 13-14: 編集機能拡張
- [ ] Undo/Redo システム
- [ ] コピー・ペースト機能
- [ ] 範囲選択での一括編集
- [ ] 音符の移調機能

#### 2.2.4 Sprint 15-16: 表示機能強化
- [ ] ズーム機能
- [ ] スクロール機能改善
- [ ] 表示設定の保存
- [ ] 色分け機能

### 2.3 Phase 3: 上級機能実装 (2025年7月〜9月)

#### 2.3.1 Sprint 17-18: オートメーション
- [ ] コントロールチェンジ編集
- [ ] ピッチベンド編集
- [ ] テンポチェンジ編集
- [ ] オートメーションレーン表示

#### 2.3.2 Sprint 19-20: 高度な編集
- [ ] 音符のランダマイズ
- [ ] パターン複製・ループ
- [ ] 和音生成機能
- [ ] スケール・キー設定

#### 2.3.3 Sprint 21-22: プラグイン体系
- [ ] プラグインアーキテクチャ設計
- [ ] 基本プラグインの実装
- [ ] プラグインマネージャー
- [ ] サードパーティプラグイン対応

#### 2.3.4 Sprint 23-24: 最終調整・リリース準備
- [ ] 性能最適化
- [ ] バグ修正
- [ ] ドキュメント整備
- [ ] パッケージング・配布準備

## 3. 技術スタック

### 3.1 コア技術
```
GUI Framework: PySide6 (Qt6)
MIDI Processing: mido
MIDI I/O: python-rtmidi
Data Serialization: JSON / pickle
Testing: pytest
Documentation: Sphinx
```

### 3.2 開発ツール
```
IDE: VSCode / PyCharm
Version Control: Git
Package Manager: pip
Code Formatter: black
Linter: flake8
Type Checker: mypy
```

### 3.3 配布形式
```
Source Distribution: PyPI
Binary Distribution: PyInstaller
Platform Packages: Windows MSI, macOS DMG, Linux AppImage
```

## 4. プロジェクト構造

### 4.1 現在のディレクトリ構造
```
pydominodev/
├── src/
│   ├── main.py                 # アプリケーションエントリーポイント
│   ├── midi_data_model.py      # MIDIデータモデル
│   ├── midi_parser.py          # MIDIファイル処理
│   └── ui/
│       ├── main_window.py      # メインウィンドウ
│       ├── piano_roll_widget.py # ピアノロールエディター
│       └── piano_keyboard_widget.py # ピアノキーボード表示
├── tests/                      # テストファイル
├── requirements.txt           # 依存パッケージ
├── REQUIREMENTS.md           # 要件定義書
└── DEVELOPMENT_PLAN.md       # 開発計画書（本ファイル）
```

### 4.2 目標のディレクトリ構造
```
pydominodev/
├── src/
│   ├── main.py
│   ├── core/                  # コア機能
│   │   ├── midi_data_model.py
│   │   ├── midi_parser.py
│   │   ├── project_manager.py
│   │   └── audio_engine.py
│   ├── ui/                    # UI コンポーネント
│   │   ├── main_window.py
│   │   ├── piano_roll_widget.py
│   │   ├── piano_keyboard_widget.py
│   │   ├── track_panel.py
│   │   └── transport_controls.py
│   ├── utils/                 # ユーティリティ
│   │   ├── config.py
│   │   ├── shortcuts.py
│   │   └── file_utils.py
│   └── plugins/               # プラグインシステム
│       ├── __init__.py
│       └── base_plugin.py
├── tests/                     # テストファイル
├── docs/                      # ドキュメント
├── assets/                    # リソースファイル
├── requirements.txt
├── setup.py
└── README.md
```

## 5. 品質管理

### 5.1 テスト戦略
- **ユニットテスト**: 各モジュールの単体テスト
- **統合テスト**: モジュール間の連携テスト
- **UIテスト**: 手動テストによるUI動作確認
- **パフォーマンステスト**: 大量データでの性能測定

### 5.2 コード品質
- **コードレビュー**: 自己レビュー + 定期的なリファクタリング
- **静的解析**: flake8, mypy による品質チェック
- **コードフォーマット**: black による自動フォーマット
- **ドキュメント**: docstring による適切な文書化

### 5.3 リリース管理
- **バージョニング**: セマンティックバージョニング採用
- **リリースサイクル**: 月次リリース（開発中）
- **変更管理**: CHANGELOG.md による変更履歴管理
- **バックアップ**: 定期的なコードバックアップ

## 6. リスク管理

### 6.1 技術的リスク

#### 6.1.1 PySide6 習得コスト
- **リスク**: Qt フレームワークの学習コスト
- **対策**: 段階的な機能実装、サンプルコードの活用

#### 6.1.2 MIDI処理の複雑さ
- **リスク**: MIDI仕様の複雑さによる実装困難
- **対策**: 既存ライブラリ（mido）の活用、段階的実装

#### 6.1.3 性能問題
- **リスク**: 大量データでの動作遅延
- **対策**: 早期の性能テスト、効率的なデータ構造採用

### 6.2 スケジュールリスク

#### 6.2.1 機能範囲の拡大
- **リスク**: 要件の拡大による開発遅延
- **対策**: MVP（最小限の機能）優先、段階的リリース

#### 6.2.2 予期しないバグ
- **リスク**: 複雑なバグによる開発停滞
- **対策**: 定期的なテスト、小さな変更でのコミット

### 6.3 対策

#### 6.3.1 定期的な振り返り
- **頻度**: 2週間ごと
- **内容**: 進捗確認、課題の特定、計画の調整

#### 6.3.2 技術的負債の管理
- **方針**: 新機能実装の合間にリファクタリング
- **指標**: コードの複雑度、テストカバレッジ

## 7. 成果物

### 7.1 Phase 1 成果物
- [ ] 基本的なピアノロールエディター
- [ ] MIDIファイル読み込み・保存機能
- [ ] 基本的な編集機能（作成・削除・移動・リサイズ）
- [ ] プロジェクトファイル形式の確立

### 7.2 Phase 2 成果物
- [ ] MIDI再生・録音機能
- [ ] 高度な編集機能（コピー・ペースト・Undo/Redo）
- [ ] 改良されたユーザーインターフェース
- [ ] 設定・カスタマイズ機能

### 7.3 Phase 3 成果物
- [ ] オートメーション機能
- [ ] プラグインシステム
- [ ] 配布可能パッケージ
- [ ] 完成したドキュメント

## 8. 次のステップ

### 8.1 直近の作業（1-2週間）
1. [ ] 複数音符選択機能の実装
2. [ ] MIDIファイル保存機能の実装
3. [ ] 基本的なキーボードショートカット
4. [ ] エラーハンドリングの改善

### 8.2 中期的な作業（1-2ヶ月）
1. [ ] 再生機能の実装
2. [ ] トラック管理機能の強化
3. [ ] Undo/Redo システムの実装
4. [ ] UI/UX の改善

### 8.3 長期的な目標（3-6ヶ月）
1. [ ] 商用利用可能な品質の達成
2. [ ] プラグインエコシステムの構築
3. [ ] コミュニティの形成
4. [ ] 継続的な機能追加・改善