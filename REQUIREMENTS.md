# PyDomino - 要件定義書

## 1. プロジェクト概要

### 1.1 プロジェクト名
PyDomino - Python製MIDIシーケンサー

### 1.2 目的
Windows用MIDIシーケンサー「Domino」のPythonクローンを開発し、クロスプラットフォーム対応のMIDI制作環境を提供する。

### 1.3 対象ユーザー
- MIDI音楽制作者
- DTM初心者〜中級者
- Dominoユーザー（移行・補完用途）

## 2. 機能要件

### 2.1 コア機能（Phase 1）

#### 2.1.1 ピアノロールエディター
- [x] 音符の表示・編集
- [x] 音符の作成（左クリック）
- [x] 音符の削除（右クリック・Deleteキー）
- [x] 音符の選択・移動（ドラッグ）
- [x] 音符の長さ調整（リサイズ）
- [x] 量子化グリッド表示
- [ ] 複数音符の選択（矩形選択・Ctrl+クリック）
- [ ] 範囲選択でのコピー・ペースト
- [ ] 音符のベロシティ編集
- [ ] 音符の重複チェック・解決

#### 2.1.2 トラック管理
- [x] 基本的なトラック表示
- [ ] 複数トラックの管理
- [ ] トラックの追加・削除
- [ ] トラック名の編集
- [ ] トラックのミュート・ソロ
- [ ] 楽器（プログラム）の選択
- [ ] チャンネル設定

#### 2.1.3 ファイル操作
- [x] MIDIファイルの読み込み
- [ ] MIDIファイルの保存
- [ ] プロジェクトファイルの保存・読み込み
- [ ] エクスポート機能

### 2.2 中級機能（Phase 2）

#### 2.2.1 再生・録音機能
- [ ] MIDIファイルの再生
- [ ] 一時停止・停止
- [ ] 再生位置の制御
- [ ] メトロノーム機能
- [ ] リアルタイム録音（MIDI入力）
- [ ] 録音時の量子化

#### 2.2.2 編集機能
- [ ] 元に戻す・やり直し（Undo/Redo）
- [ ] 範囲選択での一括編集
- [ ] 音符の移調（transpose）
- [ ] 音符の時間シフト
- [ ] ベロシティの一括変更
- [ ] 長さの一括変更

#### 2.2.3 表示機能
- [ ] ズーム機能（水平・垂直）
- [ ] スクロール機能
- [ ] 小節線・拍線の表示
- [ ] 鍵盤表示の改善
- [ ] 音符の色分け（チャンネル・トラック別）

### 2.3 上級機能（Phase 3）

#### 2.3.1 オートメーション
- [ ] コントロールチェンジ（CC）の編集
- [ ] ピッチベンドの編集
- [ ] テンポチェンジの編集
- [ ] ボリューム・パンの編集

#### 2.3.2 高度な編集
- [ ] 音符のランダマイズ
- [ ] パターンの複製・ループ
- [ ] 和音生成機能
- [ ] スケール・キー設定
- [ ] 音符のクオンタイズ（後から）

#### 2.3.3 UI/UX改善
- [ ] カスタマイズ可能なキーボードショートカット
- [ ] テーマ・カラーリング
- [ ] ツールバーのカスタマイズ
- [ ] 状態保存・復元

## 3. 非機能要件

### 3.1 性能要件
- 大量の音符（10,000+）でも快適に動作
- リアルタイム再生時のレイテンシ < 10ms
- ファイル読み込み時間 < 5秒（一般的なMIDIファイル）

### 3.2 互換性要件
- Windows 10/11対応
- macOS 10.15+対応
- Linux（Ubuntu 20.04+）対応
- Python 3.8+対応

### 3.3 ユーザビリティ要件
- 直感的なUI設計
- Dominoユーザーが違和感なく使用可能
- 充実したキーボードショートカット

## 4. 技術要件

### 4.1 開発環境
- Python 3.8+
- PySide6（Qt GUI）
- mido（MIDI処理）
- python-rtmidi（MIDI I/O）

### 4.2 アーキテクチャ
- MVC パターンの採用
- モジュール化された設計
- 拡張可能なプラグイン体系

### 4.3 データ形式
- 標準MIDIファイル（.mid, .midi）
- 独自プロジェクトファイル（.pydmn）
- 設定ファイル（JSON）

## 5. 制約事項

### 5.1 技術的制約
- GUI フレームワーク: PySide6固定
- MIDI I/O: python-rtmidi使用
- オーディオ機能は対象外

### 5.2 リソース制約
- 個人開発プロジェクト
- 短期間での完成を目指す
- 外部ライブラリの最小限使用

## 6. 品質要件

### 6.1 信頼性
- クラッシュ耐性
- データ損失の防止
- 自動保存機能

### 6.2 保守性
- 明確なコード構造
- 適切なドキュメント
- ユニットテストの実装

### 6.3 拡張性
- 新機能の追加が容易
- プラグイン体系の準備
- 設定の外部化

## 7. 受け入れ基準

### 7.1 Phase 1完了条件
- 基本的なピアノロール編集が可能
- MIDIファイルの読み込み・保存
- 安定した動作

### 7.2 Phase 2完了条件
- 再生・録音機能の実装
- 基本的な編集機能の完成
- ユーザビリティの向上

### 7.3 Phase 3完了条件
- 高度な編集機能の実装
- プラグイン体系の構築
- 商用利用可能な品質

## 8. リスク管理

### 8.1 技術的リスク
- PySide6の学習コスト
- MIDI処理の複雑さ
- 性能問題の発生

### 8.2 対策
- 段階的な開発
- 早期のプロトタイピング
- 定期的なパフォーマンステスト